<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>i春秋公益赛_部分re题目 - EP`s blog</title><meta name="Description" content="关于 LoveIt 主题"><meta property="og:title" content="i春秋公益赛_部分re题目" />
<meta property="og:description" content="First 官方wp有点简略&hellip;研究了一下补个详细的。我好菜我好菜我好菜。很多代码都是官方wp里面的，拿过来做个笔记. 奇怪的安装包 这道题其" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/" />
<meta property="og:image" content="https://linkleyping.top/logo.png"/>
<meta property="article:published_time" content="2020-04-05T15:22:45+08:00" />
<meta property="article:modified_time" content="2020-04-05T15:22:45+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://linkleyping.top/logo.png"/>

<meta name="twitter:title" content="i春秋公益赛_部分re题目"/>
<meta name="twitter:description" content="First 官方wp有点简略&hellip;研究了一下补个详细的。我好菜我好菜我好菜。很多代码都是官方wp里面的，拿过来做个笔记. 奇怪的安装包 这道题其"/>
<meta name="application-name" content="EP`s blog">
<meta name="apple-mobile-web-app-title" content="EP`s blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/" /><link rel="prev" href="https://linkleyping.top/nu1l%E7%AC%AC%E4%B8%80%E6%AC%A1re%E5%85%AC%E5%BC%80%E8%B5%9B/" /><link rel="next" href="https://linkleyping.top/%E6%AF%8F%E6%97%A5%E6%80%BB%E7%BB%93-%E7%AC%AC%E5%8D%81%E5%A4%A9%E6%B1%87%E7%BC%96%E8%80%83%E8%AF%95%E5%87%86%E5%A4%87/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "i春秋公益赛_部分re题目",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/linkleyping.top\/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B\/"
        },"image": ["https:\/\/linkleyping.top\/images\/Apple-Devices-Preview.png"],"genre": "posts","wordcount":  8380 ,
        "url": "https:\/\/linkleyping.top\/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B\/","datePublished": "2020-04-05T15:22:45+08:00","dateModified": "2020-04-05T15:22:45+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/linkleyping.top\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "EP"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">  
    <div class="header-wrapper">  
        <div class="header-title">  
            <a href="/" title="EP`s blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/icon.png"
        data-srcset="/images/icon.png, /images/icon.png 1.5x, /images/icon.png 2x"
        data-sizes="auto"
        alt="/images/icon.png"
        title="/images/icon.png" />EP`s blog</a>  
        </div>  
        <div class="menu">  
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/LinkleYping" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">  
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">  
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">  
                            <i class="fas fa-search fa-fw"></i>  
                        </a>  
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">  
                            <i class="fas fa-times-circle fa-fw"></i>  
                        </a>  
                        <span class="search-button search-loading" id="search-loading-desktop">  
                            <i class="fas fa-spinner fa-fw fa-spin"></i>  
                        </span>  
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">  
                    <i class="fas fa-adjust fa-fw"></i>  
                </a>  
            </div>  
        </div>  
    </div>  
</header><header class="mobile" id="header-mobile">  
    <div class="header-container">  
        <div class="header-wrapper">  
            <div class="header-title">  
                <a href="/" title="EP`s blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/icon.png"
        data-srcset="/images/icon.png, /images/icon.png 1.5x, /images/icon.png 2x"
        data-sizes="auto"
        alt="/images/icon.png"
        title="/images/icon.png" />EP`s blog</a>  
            </div>  
            <div class="menu-toggle" id="menu-toggle-mobile">  
                <span></span><span></span><span></span>  
            </div>  
        </div>  
        <div class="menu" id="menu-mobile"><div class="search-wrapper">  
                    <div class="search mobile" id="search-mobile">  
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">  
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">  
                            <i class="fas fa-search fa-fw"></i>  
                        </a>  
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">  
                            <i class="fas fa-times-circle fa-fw"></i>  
                        </a>  
                        <span class="search-button search-loading" id="search-loading-mobile">  
                            <i class="fas fa-spinner fa-fw fa-spin"></i>  
                        </span>  
                    </div>  
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">  
                        取消  
                    </a>  
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/LinkleYping" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">  
                <i class="fas fa-adjust fa-fw"></i>  
            </a></div>  
    </div>  
</header>  
<div class="search-dropdown desktop">  
    <div id="search-dropdown-desktop"></div>  
</div>  
<div class="search-dropdown mobile">  
    <div id="search-dropdown-mobile"></div>  
</div>  
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">i春秋公益赛_部分re题目</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://linkleyping.top" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>EP</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/writeup/"><i class="far fa-folder fa-fw"></i>writeup</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-04-05">2020-04-05</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 8380 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 17 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#first">First</a></li>
    <li><a href="#奇怪的安装包">奇怪的安装包</a></li>
    <li><a href="#crackme">CrackMe</a></li>
    <li><a href="#factory">Factory</a></li>
    <li><a href="#code2">Code2</a></li>
    <li><a href="#veryeasyre">Veryeasyre</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="first">First</h2>
<p>官方wp有点简略&hellip;研究了一下补个详细的。我好菜我好菜我好菜。很多代码都是官方wp里面的，拿过来做个笔记.</p>
<h2 id="奇怪的安装包">奇怪的安装包</h2>
<p>这道题其实不是很难,但是我是动态调试做出来的,看到wp上的解法要简单很多。   <br>
这里的安装包使用nsis打包,NSIS的打包教程如下:   <br>
<a href="https://blog.csdn.net/myiloveuuu/article/details/78400153" target="_blank" rel="noopener noreffer">使用nsis打包程序</a>   <br>
其中有NSIS脚本可以自定义安装的步骤,所以这个题目中弹出的key和flag的验证窗口就是写在NSIS脚本中的。   <br>
我本来觉得是应该有脚本的,我用了普通解压的方式解开了exe文件,但是并没有发现NSIS脚本。后来知道是NSIS后查了一下,发现只有19.00版本的7z才可以解压得到NSIS脚本。具体可以在这里下载：   <br>
<a href="https://www.52pojie.cn/thread-877884-1-1.html" target="_blank" rel="noopener noreffer">7-Zip 19.00 增加nsis脚本反编译版</a>   <br>
flag部分的验证过程如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">Dialogs::InputBox <span class="m">1</span> 请输入flag <span class="s2">&#34;Input your flag&#34;</span> 确定 取消 <span class="m">4</span> <span class="m">6</span>    
<span class="p">;</span> Call Initialize_____Plugins    
<span class="p">;</span> AllowSkipFiles off    
<span class="p">;</span> File <span class="nv">$PLUGINSDIR</span><span class="se">\D</span>ialogs.dll    
<span class="p">;</span> SetDetailsPrint lastused    
<span class="p">;</span> Push <span class="m">6</span>    
<span class="p">;</span> Push <span class="m">4</span>    
<span class="p">;</span> Push 取消    
<span class="p">;</span> Push 确定    
<span class="p">;</span> Push <span class="s2">&#34;Input your flag&#34;</span>    
<span class="p">;</span> Push 请输入flag    
<span class="p">;</span> Push <span class="m">1</span>    
<span class="p">;</span> CallInstDLL <span class="nv">$PLUGINSDIR</span><span class="se">\D</span>ialogs.dll InputBox    
IntCmp <span class="nv">$4</span> <span class="m">1</span> <span class="m">0</span> label_415 label_415    
Push <span class="nv">$6</span>    
Call func_429    
Pop <span class="nv">$6</span>    
StrCpy <span class="nv">$3</span> gm<span class="sb">`</span>fzd787<span class="sb">`</span>7bb,g72d,592b,8<span class="sb">`</span>g1,cg96813e8d<span class="sb">``</span><span class="p">|</span>    
StrCmp <span class="nv">$3</span> <span class="nv">$6</span> <span class="m">0</span> label_417    
MessageBox MB_OK flag正确,可以愉快的玩游戏了    
Goto label_419    
    
Function func_429    
Pop <span class="nv">$9</span>    
StrCpy <span class="nv">$3</span> <span class="s2">&#34;&#34;</span>    
StrCpy <span class="nv">$0</span> <span class="nv">$9</span>    
StrCpy <span class="nv">$1</span> <span class="m">0</span>    
label_433:    
StrCpy <span class="nv">$2</span> <span class="nv">$0</span> <span class="m">1</span> <span class="nv">$1</span>    
StrCmp <span class="nv">$2</span> <span class="s2">&#34;&#34;</span> label_443    
Push <span class="nv">$2</span>    
Call func_445    
Pop <span class="nv">$2</span>    
IntOp <span class="nv">$2</span> <span class="nv">$2</span> ^ <span class="m">1</span>    
IntFmt <span class="nv">$2</span> %c <span class="nv">$2</span>    
IntOp <span class="nv">$1</span> <span class="nv">$1</span> + <span class="m">1</span>    
StrCpy <span class="nv">$3</span> <span class="nv">$3$2</span>    
Goto label_433    
label_443:    
Push <span class="nv">$3</span>    
FunctionEnd    
    
Function func_445    
Exch <span class="nv">$0</span>    
<span class="p">;</span> Push <span class="nv">$0</span>    
<span class="p">;</span> Exch    
<span class="p">;</span> Pop <span class="nv">$0</span>    
Push <span class="nv">$1</span>    
Push <span class="nv">$2</span>    
StrCpy <span class="nv">$2</span> <span class="m">1</span>    
label_451:    
IntFmt <span class="nv">$1</span> %c <span class="nv">$2</span>    
StrCmpS <span class="nv">$1</span> <span class="nv">$0</span> <span class="m">0</span> label_455    
StrCpy <span class="nv">$0</span> <span class="nv">$2</span>    
Goto label_458    
label_455:    
IntOp <span class="nv">$2</span> <span class="nv">$2</span> + <span class="m">1</span>    
StrCmp <span class="nv">$2</span> <span class="m">255</span> <span class="m">0</span> label_451    
StrCpy <span class="nv">$0</span> <span class="m">0</span>    
label_458:    
Pop <span class="nv">$2</span>    
Pop <span class="nv">$1</span>    
Exch <span class="nv">$0</span>    
<span class="p">;</span> Push <span class="nv">$0</span>    
<span class="p">;</span> Exch    
<span class="p">;</span> Pop <span class="nv">$0</span>    
FunctionEnd    
</code></pre></td></tr></table>
</div>
</div><p>过程就是与1异或以后的值与gm`fzd787`7bb,g72d,592b,8`g1,cg96813e8d``|相等</p>
<h2 id="crackme">CrackMe</h2>
<p>是一个修改了的AES代码(加密前后各多了一个异或的操作，并且替换了常用的S盒,代码里面还比较贴心的给了对应的逆S盒),官方给了一个比较齐全的AES的c代码(查表法),留作参考,毕竟让我自己看我是看不出来的&hellip;对照着看还有可能&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="c1">//    
</span><span class="c1">//  AES.hpp    
</span><span class="c1">//  AES    
</span><span class="c1">//    
</span><span class="c1">//  Created by zoe on 2020/3/3.    
</span><span class="c1">//  Copyright © 2020年 zoe. All rights reserved.    
</span><span class="c1">//    
</span><span class="c1"></span>    
<span class="cp">#pragma once    
</span><span class="cp">#ifndef SRC_UTILS_AES_H    
</span><span class="cp">#define SRC_UTILS_AES_H    
</span><span class="cp"></span>    
<span class="k">class</span> <span class="nc">AES</span>    
<span class="p">{</span>    
<span class="k">public</span><span class="o">:</span>    
<span class="n">AES</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">key</span><span class="p">);</span>    
<span class="k">virtual</span> <span class="o">~</span><span class="n">AES</span><span class="p">();</span>    
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">Cipher</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">);</span>    <span class="c1">// 加密，传入的数组大小必须是16字节    
</span><span class="c1"></span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">InvCipher</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">);</span>    <span class="c1">// 解密，传入的数组也必须是16字节    
</span><span class="c1"></span><span class="kt">void</span><span class="o">*</span> <span class="nf">Cipher</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>    <span class="c1">// 可以传入数组，大小必须是16的整数倍，如果不是将会越界操作；如果不传length而默认为0，那么将按照字符串处理，遇&#39;\0&#39;结束    
</span><span class="c1"></span><span class="kt">void</span><span class="o">*</span> <span class="nf">InvCipher</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">);</span>    <span class="c1">// 必须传入数组和大小，必须是16的整数倍    
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">AddRoundKey</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">],</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">k</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="k">private</span><span class="o">:</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">Sbox</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">InvSbox</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">w</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>    
    
<span class="kt">void</span> <span class="nf">KeyExpansion</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">w</span><span class="p">[][</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">FFmul</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">a</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span><span class="p">);</span>    
    
<span class="kt">void</span> <span class="nf">SubBytes</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="kt">void</span> <span class="nf">ShiftRows</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="kt">void</span> <span class="nf">MixColumns</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
    
    
<span class="kt">void</span> <span class="nf">InvSubBytes</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="kt">void</span> <span class="nf">InvShiftRows</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="kt">void</span> <span class="nf">InvMixColumns</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">]);</span>    
<span class="p">};</span>    
    
<span class="cp">#endif    </span><span class="c1">// SRC_UTILS_AES_H    
</span><span class="c1"></span>    
<span class="c1">//    
</span><span class="c1">//  AES.cpp    
</span><span class="c1">//  AES    
</span><span class="c1">//    
</span><span class="c1">//  Created by zoe on 2020/3/3.    
</span><span class="c1">//  Copyright © 2020年 zoe. All rights reserved.    
</span><span class="c1">//    
</span><span class="c1"></span>    
<span class="cp">#include</span> <span class="cpf">&#34;AES.hpp&#34;    </span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&#34;string.h&#34;    </span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>    
    
<span class="n">AES</span><span class="o">::</span><span class="n">AES</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">key</span><span class="p">)</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">sBox</span><span class="p">[]</span> <span class="o">=</span>    
<span class="p">{</span>    
    <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span>    
    <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span>    
    <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span>    
    <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span>    
    <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span>    
    <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span>    
    <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span>    
    <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span>    
    <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span>    
    <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span>    
    <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span>    
    <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span>    
    <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span>    
    <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span>    
    <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span>    
    <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0xF2</span>    
<span class="p">};</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">invsBox</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span>    
<span class="p">{</span>    
    <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span>    
    <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span>    
    <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span>    
    <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span>    
    <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span>    
    <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span>    
    <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x7c</span><span class="p">,</span>    
    <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span>    
    <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span>    
    <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span>    
    <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span>    
    <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span>    
    <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span>    
    <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span>    
    <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span>    
    <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xca</span>    
<span class="p">};</span>    
    
<span class="cm">/*    
</span><span class="cm"> unsigned char sBox[] =    
</span><span class="cm"> {    
</span><span class="cm"> 0x63,0x7c,0x77,0x7b,0xf2,0x6b,0x6f,0xc5,0x30,0x01,0x67,0x2b,0xfe,0xd7,0xab,0x76,    
</span><span class="cm"> 0xca,0x82,0xc9,0x7d,0xfa,0x59,0x47,0xf0,0xad,0xd4,0xa2,0xaf,0x9c,0xa4,0x72,0xc0,    
</span><span class="cm"> 0xb7,0xfd,0x93,0x26,0x36,0x3f,0xf7,0xcc,0x34,0xa5,0xe5,0xf1,0x71,0xd8,0x31,0x15,    
</span><span class="cm"> 0x04,0xc7,0x23,0xc3,0x18,0x96,0x05,0x9a,0x07,0x12,0x80,0xe2,0xeb,0x27,0xb2,0x75,    
</span><span class="cm"> 0x09,0x83,0x2c,0x1a,0x1b,0x6e,0x5a,0xa0,0x52,0x3b,0xd6,0xb3,0x29,0xe3,0x2f,0x84,    
</span><span class="cm"> 0x53,0xd1,0x00,0xed,0x20,0xfc,0xb1,0x5b,0x6a,0xcb,0xbe,0x39,0x4a,0x4c,0x58,0xcf,    
</span><span class="cm"> 0xd0,0xef,0xaa,0xfb,0x43,0x4d,0x33,0x85,0x45,0xf9,0x02,0x7f,0x50,0x3c,0x9f,0xa8,    
</span><span class="cm"> 0x51,0xa3,0x40,0x8f,0x92,0x9d,0x38,0xf5,0xbc,0xb6,0xda,0x21,0x10,0xff,0xf3,0xd2,    
</span><span class="cm"> 0xcd,0x0c,0x13,0xec,0x5f,0x97,0x44,0x17,0xc4,0xa7,0x7e,0x3d,0x64,0x5d,0x19,0x73,    
</span><span class="cm"> 0x60,0x81,0x4f,0xdc,0x22,0x2a,0x90,0x88,0x46,0xee,0xb8,0x14,0xde,0x5e,0x0b,0xdb,    
</span><span class="cm"> 0xe0,0x32,0x3a,0x0a,0x49,0x06,0x24,0x5c,0xc2,0xd3,0xac,0x62,0x91,0x95,0xe4,0x79,    
</span><span class="cm"> 0xe7,0xc8,0x37,0x6d,0x8d,0xd5,0x4e,0xa9,0x6c,0x56,0xf4,0xea,0x65,0x7a,0xae,0x08,    
</span><span class="cm"> 0xba,0x78,0x25,0x2e,0x1c,0xa6,0xb4,0xc6,0xe8,0xdd,0x74,0x1f,0x4b,0xbd,0x8b,0x8a,    
</span><span class="cm"> 0x70,0x3e,0xb5,0x66,0x48,0x03,0xf6,0x0e,0x61,0x35,0x57,0xb9,0x86,0xc1,0x1d,0x9e,    
</span><span class="cm"> 0xe1,0xf8,0x98,0x11,0x69,0xd9,0x8e,0x94,0x9b,0x1e,0x87,0xe9,0xce,0x55,0x28,0xdf,    
</span><span class="cm"> 0x8c,0xa1,0x89,0x0d,0xbf,0xe6,0x42,0x68,0x41,0x99,0x2d,0x0f,0xb0,0x54,0xbb,0x16    
</span><span class="cm"> };    
</span><span class="cm"> unsigned char invsBox[256] =    
</span><span class="cm"> {    
</span><span class="cm"> 0x52,0x09,0x6a,0xd5,0x30,0x36,0xa5,0x38,0xbf,0x40,0xa3,0x9e,0x81,0xf3,0xd7,0xfb,    
</span><span class="cm"> 0x7c,0xe3,0x39,0x82,0x9b,0x2f,0xff,0x87,0x34,0x8e,0x43,0x44,0xc4,0xde,0xe9,0xcb,    
</span><span class="cm"> 0x54,0x7b,0x94,0x32,0xa6,0xc2,0x23,0x3d,0xee,0x4c,0x95,0x0b,0x42,0xfa,0xc3,0x4e,    
</span><span class="cm"> 0x08,0x2e,0xa1,0x66,0x28,0xd9,0x24,0xb2,0x76,0x5b,0xa2,0x49,0x6d,0x8b,0xd1,0x25,    
</span><span class="cm"> 0x72,0xf8,0xf6,0x64,0x86,0x68,0x98,0x16,0xd4,0xa4,0x5c,0xcc,0x5d,0x65,0xb6,0x92,    
</span><span class="cm"> 0x6c,0x70,0x48,0x50,0xfd,0xed,0xb9,0xda,0x5e,0x15,0x46,0x57,0xa7,0x8d,0x9d,0x84,    
</span><span class="cm"> 0x90,0xd8,0xab,0x00,0x8c,0xbc,0xd3,0x0a,0xf7,0xe4,0x58,0x05,0xb8,0xb3,0x45,0x06,    
</span><span class="cm"> 0xd0,0x2c,0x1e,0x8f,0xca,0x3f,0x0f,0x02,0xc1,0xaf,0xbd,0x03,0x01,0x13,0x8a,0x6b,    
</span><span class="cm"> 0x3a,0x91,0x11,0x41,0x4f,0x67,0xdc,0xea,0x97,0xf2,0xcf,0xce,0xf0,0xb4,0xe6,0x73,    
</span><span class="cm"> 0x96,0xac,0x74,0x22,0xe7,0xad,0x35,0x85,0xe2,0xf9,0x37,0xe8,0x1c,0x75,0xdf,0x6e,    
</span><span class="cm"> 0x47,0xf1,0x1a,0x71,0x1d,0x29,0xc5,0x89,0x6f,0xb7,0x62,0x0e,0xaa,0x18,0xbe,0x1b,    
</span><span class="cm"> 0xfc,0x56,0x3e,0x4b,0xc6,0xd2,0x79,0x20,0x9a,0xdb,0xc0,0xfe,0x78,0xcd,0x5a,0xf4,    
</span><span class="cm"> 0x1f,0xdd,0xa8,0x33,0x88,0x07,0xc7,0x31,0xb1,0x12,0x10,0x59,0x27,0x80,0xec,0x5f,    
</span><span class="cm"> 0x60,0x51,0x7f,0xa9,0x19,0xb5,0x4a,0x0d,0x2d,0xe5,0x7a,0x9f,0x93,0xc9,0x9c,0xef,    
</span><span class="cm"> 0xa0,0xe0,0x3b,0x4d,0xae,0x2a,0xf5,0xb0,0xc8,0xeb,0xbb,0x3c,0x83,0x53,0x99,0x61,    
</span><span class="cm"> 0x17,0x2b,0x04,0x7e,0xba,0x77,0xd6,0x26,0xe1,0x69,0x14,0x63,0x55,0x21,0x0c,0x7d    
</span><span class="cm"> };*/</span>    
    
<span class="n">memcpy</span><span class="p">(</span><span class="n">Sbox</span><span class="p">,</span> <span class="n">sBox</span><span class="p">,</span> <span class="mi">256</span><span class="p">);</span>    
<span class="n">memcpy</span><span class="p">(</span><span class="n">InvSbox</span><span class="p">,</span> <span class="n">invsBox</span><span class="p">,</span> <span class="mi">256</span><span class="p">);</span>    
<span class="n">KeyExpansion</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>    
<span class="p">}</span>    
    
<span class="n">AES</span><span class="o">::~</span><span class="n">AES</span><span class="p">()</span>    
<span class="p">{</span>    
    
<span class="p">}</span>    
    
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">AES</span><span class="o">::</span><span class="n">Cipher</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">)</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="kt">int</span> <span class="n">key1</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span> <span class="p">};</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">r</span><span class="p">]</span><span class="o">^</span><span class="n">key1</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span><span class="c1">//后来添加的    
</span><span class="c1"></span>    <span class="p">}</span>    
<span class="p">}</span>    
    
<span class="n">AddRoundKey</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>    
    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="n">SubBytes</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>    
    <span class="n">ShiftRows</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>    
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">)</span><span class="n">MixColumns</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>    
    <span class="n">AddRoundKey</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>    
<span class="p">}</span>    
<span class="kt">int</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">};</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">input</span><span class="p">[</span><span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">^</span><span class="n">key</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span><span class="c1">//后来添加的    
</span><span class="c1"></span>    <span class="p">}</span>    
<span class="p">}</span>    
    
<span class="k">return</span> <span class="n">input</span><span class="p">;</span>    
<span class="p">}</span>    
    
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">AES</span><span class="o">::</span><span class="n">InvCipher</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">)</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="kt">int</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">};</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">r</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>  <span class="c1">//解密的过程也加上这部分    
</span><span class="c1"></span>    <span class="p">}</span>    
<span class="p">}</span>    
    
<span class="n">AddRoundKey</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="mi">10</span><span class="p">]);</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="n">InvShiftRows</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>    
    <span class="n">InvSubBytes</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>    
    <span class="n">AddRoundKey</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>    
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">InvMixColumns</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="kt">int</span> <span class="n">key1</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x77</span> <span class="p">};</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">input</span><span class="p">[</span><span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">^</span> <span class="n">key1</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
    
<span class="k">return</span> <span class="n">input</span><span class="p">;</span>    
<span class="p">}</span>    
    
<span class="kt">void</span><span class="o">*</span> <span class="n">AES</span><span class="o">::</span><span class="n">Cipher</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">in</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">input</span><span class="p">;</span>    
<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>    
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">length</span><span class="p">)</span>        <span class="c1">// 如果是0则当做字符串处理    
</span><span class="c1"></span><span class="p">{</span>    
    <span class="k">while</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">in</span> <span class="o">+</span> <span class="n">length</span><span class="o">++</span><span class="p">));</span>    
    <span class="n">in</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">input</span><span class="p">;</span>    
<span class="p">}</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="n">Cipher</span><span class="p">(</span><span class="n">in</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>    
<span class="p">}</span>    
<span class="k">return</span> <span class="n">input</span><span class="p">;</span>    
<span class="p">}</span>    
    
<span class="kt">void</span><span class="o">*</span> <span class="n">AES</span><span class="o">::</span><span class="n">InvCipher</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">in</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">input</span><span class="p">;</span>    
<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="n">InvCipher</span><span class="p">(</span><span class="n">in</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>    
<span class="p">}</span>    
<span class="k">return</span> <span class="n">input</span><span class="p">;</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">KeyExpansion</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">w</span><span class="p">[][</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="c1">//----------------------------------------------------
</span><span class="c1"></span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">rc</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x36</span> <span class="p">};</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>    
<span class="c1">//            int kk = r + c * 4;    
</span><span class="c1"></span>    <span class="p">}</span>    
<span class="p">}</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
        <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
        <span class="p">{</span>    
            <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">?</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">r</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">][</span><span class="mi">3</span><span class="p">];</span>    
        <span class="p">}</span>    
        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>    
        <span class="p">{</span>    
            <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>    
            <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
            <span class="p">{</span>    
                <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sbox</span><span class="p">[</span><span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]];</span>    
            <span class="p">}</span>    
            <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sbox</span><span class="p">[</span><span class="n">temp</span><span class="p">];</span>    
            <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rc</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>    
        <span class="p">}</span>    
        <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
        <span class="p">{</span>    
            <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">r</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">];</span>    
        <span class="p">}</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">AES</span><span class="o">::</span><span class="n">FFmul</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">a</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span><span class="p">)</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">bw</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>    
<span class="n">bw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="n">bw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bw</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>    
    <span class="k">if</span> <span class="p">(</span><span class="n">bw</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">bw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x1b</span><span class="p">;</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">if</span> <span class="p">((</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">res</span> <span class="o">^=</span> <span class="n">bw</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="k">return</span> <span class="n">res</span><span class="p">;</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">SubBytes</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sbox</span><span class="p">[</span><span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">ShiftRows</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">t</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][(</span><span class="n">c</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">];</span>    
    <span class="p">}</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">MixColumns</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>    
    <span class="p">}</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x02</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>    
        <span class="o">^</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x03</span><span class="p">,</span> <span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])</span>    
        <span class="o">^</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])</span>    
        <span class="o">^</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]);</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">AddRoundKey</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">k</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">^=</span> <span class="n">k</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">InvSubBytes</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">InvSbox</span><span class="p">[</span><span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">InvShiftRows</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">t</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][(</span><span class="n">c</span> <span class="o">-</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">];</span>    
    <span class="p">}</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="kt">void</span> <span class="n">AES</span><span class="o">::</span><span class="n">InvMixColumns</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">state</span><span class="p">[][</span><span class="mi">4</span><span class="p">])</span>    
<span class="p">{</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
<span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>    
<span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>    
    <span class="p">}</span>    
    <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="n">state</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x0e</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>    
        <span class="o">^</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x0b</span><span class="p">,</span> <span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])</span>    
        <span class="o">^</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x0d</span><span class="p">,</span> <span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])</span>    
        <span class="o">^</span> <span class="n">FFmul</span><span class="p">(</span><span class="mh">0x09</span><span class="p">,</span> <span class="n">t</span><span class="p">[(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]);</span>    
    <span class="p">}</span>    
<span class="p">}</span>    
<span class="p">}</span>    
    
<span class="c1">//    
</span><span class="c1">//  main.cpp    
</span><span class="c1">//  AES    
</span><span class="c1">//    
</span><span class="c1">//  Created by zoe on 2020/3/3.    
</span><span class="c1">//  Copyright © 2020年 zoe. All rights reserved.    
</span><span class="c1">//    
</span><span class="c1"></span>    
<span class="cp">#include</span> <span class="cpf">&#34;AES.hpp&#34;    </span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;    </span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;    </span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;    </span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;    </span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>    
    
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>    
<span class="c1">//flag{8a6e13fc-4ea0-47fa-9d5c-07a3c2c28ed9}&#34;;    
</span><span class="c1"></span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">hexData</span><span class="p">[</span><span class="mi">48</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>    
    <span class="mh">0x20</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0xce</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0xb4</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0xc1</span><span class="p">,</span><span class="mh">0xbc</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0xb9</span><span class="p">,</span><span class="mh">0xe9</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0x14</span>    
<span class="p">};</span>    
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;696368756e716975&#34;</span><span class="p">;</span>    
<span class="n">AES</span> <span class="n">aes</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>    
<span class="n">aes</span><span class="p">.</span><span class="n">InvCipher</span><span class="p">(</span><span class="n">hexData</span><span class="p">,</span> <span class="mi">48</span><span class="p">);</span>    
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">48</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">hexData</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>    
        
<span class="p">}</span>    
<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>    
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>    
    
<span class="p">}</span>    
</code></pre></td></tr></table>
</div>
</div><h2 id="factory">Factory</h2>
<p>这个题是个VM, 程序利用父进程与子进程之间使用signal通信来执行opcode,且signal的注册在main之前,main之前还利用以下代码进程反调试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">v0</span> <span class="o">=</span> <span class="n">getppid</span><span class="p">();</span>    
<span class="n">snprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="mh">0x18uLL</span><span class="p">,</span> <span class="s">&#34;/proc/%d/cmdline&#34;</span><span class="p">,</span> <span class="n">v0</span><span class="p">);</span>    
<span class="n">stream</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">);</span>    
<span class="n">fgets</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v5</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">stream</span><span class="p">);</span>    
</code></pre></td></tr></table>
</div>
</div><p>signal注册的代码如下: <br>



    <div class="post-img-view">
        <a data-fancybox="gallery" href="/images/b20263284ea0618c2a1d24897c22b593/11884068-988530e8005521b1.png">
            <img src="/images/b20263284ea0618c2a1d24897c22b593/11884068-988530e8005521b1.png" alt=""  />
        </a>
    </div>
</p>
<p>子进程使用opcode执行每个handler的过程如下:   <br>



    <div class="post-img-view">
        <a data-fancybox="gallery" href="/images/b20263284ea0618c2a1d24897c22b593/11884068-3adde0ad980a2deb.png">
            <img src="/images/b20263284ea0618c2a1d24897c22b593/11884068-3adde0ad980a2deb.png" alt=""  />
        </a>
    </div>
</p>
<p>看到一个简单的关于vm解题的教程:   <br>
<a href="https://xz.aliyun.com/t/3890" target="_blank" rel="noopener noreffer">从做题到出题再到做题三部曲-VM</a>   <br>
提取opcode进行解释:(最主要的是要有寄存器、堆栈、EIP的想法)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">func34</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>    
    <span class="k">global</span> <span class="n">r0</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">oparg</span>    
    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r0&#34;</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;PUSH &#34;</span> <span class="o">+</span> <span class="n">arg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r1&#34;</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;PUSH &#34;</span> <span class="o">+</span> <span class="n">arg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r2&#34;</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;PUSH &#34;</span> <span class="o">+</span> <span class="n">arg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;arg&#34;</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;PUSH &#34;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span>    
    
<span class="k">def</span> <span class="nf">func35</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>    
    <span class="k">global</span> <span class="n">r0</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;POP &#34;</span> <span class="o">+</span> <span class="n">arg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r0&#34;</span><span class="p">:</span>    
        <span class="n">r0</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r1&#34;</span><span class="p">:</span>    
        <span class="n">r1</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r2&#34;</span><span class="p">:</span>    
        <span class="n">r2</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>    
<span class="k">def</span> <span class="nf">func36</span><span class="p">():</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;ADD r0, r1</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="k">def</span> <span class="nf">func37</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>    
    <span class="k">global</span> <span class="n">oparg</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;ADD &#34;</span> <span class="o">+</span> <span class="n">arg</span> <span class="o">+</span> <span class="s2">&#34;, &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r0&#34;</span><span class="p">:</span>    
        <span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">+</span> <span class="n">oparg</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r1&#34;</span><span class="p">:</span>    
        <span class="n">r1</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">oparg</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r2&#34;</span><span class="p">:</span>    
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">+</span> <span class="n">oparg</span>    
<span class="k">def</span> <span class="nf">func38</span><span class="p">():</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;SUB r0, r1</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="k">def</span> <span class="nf">func39</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>    
    <span class="k">global</span> <span class="n">oparg</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;SUB &#34;</span> <span class="o">+</span> <span class="n">arg</span> <span class="o">+</span> <span class="s2">&#34;, &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r0&#34;</span><span class="p">:</span>    
        <span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">-</span> <span class="n">oparg</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r1&#34;</span><span class="p">:</span>    
        <span class="n">r1</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">oparg</span>    
    <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&#34;r2&#34;</span><span class="p">:</span>    
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">oparg</span>    
<span class="k">def</span> <span class="nf">func40</span><span class="p">():</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;XOR r0, r1</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="k">def</span> <span class="nf">func41</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">flag</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;CMP r0, r1</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">r0</span> <span class="o">==</span> <span class="n">r1</span><span class="p">)</span>    
<span class="k">def</span> <span class="nf">func42</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">EIP</span><span class="p">,</span> <span class="n">oparg</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;PUSH EIP</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EIP</span><span class="p">)</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;MOV EIP, &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
    <span class="n">EIP</span> <span class="o">=</span> <span class="n">oparg</span>    
<span class="k">def</span> <span class="nf">func43</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">EIP</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;POP EIP</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="n">EIP</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>    
<span class="k">def</span> <span class="nf">func44</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">EIP</span><span class="p">,</span> <span class="n">oparg</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;MOV EIP, &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
    <span class="n">EIP</span> <span class="o">=</span> <span class="n">oparg</span>    
<span class="k">def</span> <span class="nf">func45</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">EIP</span><span class="p">,</span> <span class="n">oparg</span><span class="p">,</span> <span class="n">flag</span>    
    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;EQ MOV EIP, &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">oparg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="n">EIP</span> <span class="o">=</span> <span class="n">oparg</span>    
<span class="k">def</span> <span class="nf">func46</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">r2</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;PUSH input[&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">input</span><span class="p">[</span><span class="n">r2</span><span class="p">])</span>    
<span class="k">def</span> <span class="nf">func47</span><span class="p">():</span>    
    <span class="k">global</span> <span class="n">r2</span>    
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;POP input[&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;]</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
    <span class="nb">input</span><span class="p">[</span><span class="n">r2</span><span class="p">]</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>    
    
<span class="n">opcodes</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0xf</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">]</span>    
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;instructions.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w+&#34;</span><span class="p">)</span>    
<span class="n">EIP</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">r0</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">r1</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">r2</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">esp</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">r4</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>    
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">,</span> <span class="mh">0xc</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">]</span>    
<span class="n">oparg</span> <span class="o">=</span> <span class="mi">0</span>    
<span class="nb">input</span> <span class="o">=</span> <span class="p">[</span><span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>    
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>    
    <span class="n">opcode</span> <span class="o">=</span> <span class="n">opcodes</span><span class="p">[</span><span class="n">EIP</span><span class="p">]</span>    
    <span class="n">EIP</span> <span class="o">=</span> <span class="n">EIP</span> <span class="o">+</span> <span class="mi">1</span>    
    <span class="k">if</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x17</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Retn 0x17</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>    
        <span class="k">break</span>    
    <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>    
        <span class="n">oparg</span> <span class="o">=</span> <span class="n">opcodes</span><span class="p">[</span><span class="n">EIP</span><span class="p">]</span>    
        <span class="n">EIP</span> <span class="o">+=</span> <span class="mi">1</span>    
    <span class="k">if</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>    
        <span class="n">func34</span><span class="p">(</span><span class="s2">&#34;arg&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>    
        <span class="n">func34</span><span class="p">(</span><span class="s2">&#34;r0&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>    
        <span class="n">func34</span><span class="p">(</span><span class="s2">&#34;r1&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>    
        <span class="n">func34</span><span class="p">(</span><span class="s2">&#34;r2&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>    
        <span class="n">func35</span><span class="p">(</span><span class="s2">&#34;r0&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>    
        <span class="n">func35</span><span class="p">(</span><span class="s2">&#34;r1&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>    
        <span class="n">func35</span><span class="p">(</span><span class="s2">&#34;r2&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>    
        <span class="n">func36</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>    
        <span class="n">func37</span><span class="p">(</span><span class="s2">&#34;r0&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>    
        <span class="n">func37</span><span class="p">(</span><span class="s2">&#34;r1&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xa</span><span class="p">:</span>    
        <span class="n">func37</span><span class="p">(</span><span class="s2">&#34;r2&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xb</span><span class="p">:</span>    
        <span class="n">func38</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xc</span><span class="p">:</span>    
        <span class="n">func39</span><span class="p">(</span><span class="s2">&#34;r0&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xd</span><span class="p">:</span>    
        <span class="n">func39</span><span class="p">(</span><span class="s2">&#34;r1&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xe</span><span class="p">:</span>    
        <span class="n">func39</span><span class="p">(</span><span class="s2">&#34;r2&#34;</span><span class="p">)</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xf</span><span class="p">:</span>    
        <span class="n">func40</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x10</span><span class="p">:</span>    
        <span class="n">func41</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x11</span><span class="p">:</span>    
        <span class="n">func42</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">:</span>    
        <span class="n">func43</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x13</span><span class="p">:</span>    
        <span class="n">func44</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x14</span><span class="p">:</span>    
        <span class="n">func45</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x15</span><span class="p">:</span>    
        <span class="n">func46</span><span class="p">()</span>    
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x16</span><span class="p">:</span>    
        <span class="n">func47</span><span class="p">()</span>    
    <span class="k">else</span><span class="p">:</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Retn &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="k">break</span>    
</code></pre></td></tr></table>
</div>
</div><p>提取出来伪汇编代码：   <br>



    <div class="post-img-view">
        <a data-fancybox="gallery" href="/images/b20263284ea0618c2a1d24897c22b593/11884068-86e424bc80ca6aa2.png">
            <img src="/images/b20263284ea0618c2a1d24897c22b593/11884068-86e424bc80ca6aa2.png" alt=""  />
        </a>
    </div>
</p>
<p>代码的流程就是首先计算字符串长度,长度需要等于42,然后从最后一个元素开始,每一个字符异或(0x20 + 2 * i)然后减去i,最后异或(0x40 + 2 * i)</p>
<h2 id="code2">Code2</h2>
<p>没做出来&hellip;wtcl   <br>
看到wp上写的是arithmetic coding算法,中间调试的时候发现了有浮点数,所以觉得还挺奇怪的,没见过arithmetic coding算法,记录一下。   <br>
<a href="https://www.cnblogs.com/xubenben/p/3426646.html" target="_blank" rel="noopener noreffer">算术编码Arithmetic Coding</a>   <br>
这个算法大致的想法是根据一个字符与浮点数的对应表将一个字符串映射成一个浮点数,然后还可以根据这个表和最后的浮点数还原出字符串。  我感觉这个题用的算法跟给的链接的算术编码算法相比有一点区别,根据反汇编代码对原始算法进行了一些更改。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;    </span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;map&gt;    </span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;string&gt;    </span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;cassert&gt;    </span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;utility&gt;    </span><span class="cp">
</span><span class="cp"></span>    
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>    
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>    
<span class="p">{</span>    
    <span class="kt">double</span> <span class="n">High</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>    
    <span class="kt">double</span> <span class="n">Low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>    
    <span class="n">string</span> <span class="n">original</span><span class="o">=</span><span class="s">&#34;8ab86b896&#34;</span><span class="p">;</span>    
        
    <span class="c1">//create a map to store all chars and it&#39;s occurrence frequency    
</span><span class="c1"></span>    <span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">char_freq</span><span class="p">;</span>    
    <span class="n">char_freq</span><span class="p">[</span><span class="sc">&#39;8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.33333334</span><span class="p">);</span>    
    <span class="n">char_freq</span><span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="mf">0.33333334</span><span class="p">,</span><span class="mf">0.11111111</span><span class="p">);</span>    
    <span class="n">char_freq</span><span class="p">[</span><span class="sc">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="mf">0.44444445</span><span class="p">,</span><span class="mf">0.22222222</span><span class="p">);</span>    
    <span class="n">char_freq</span><span class="p">[</span><span class="sc">&#39;6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="mf">0.66666669</span><span class="p">,</span><span class="mf">0.11111111</span><span class="p">);</span>    
    <span class="n">char_freq</span><span class="p">[</span><span class="sc">&#39;9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="mf">0.777778</span><span class="p">,</span><span class="mf">0.11111111</span><span class="p">);</span>    
    <span class="n">char_freq</span><span class="p">[</span><span class="sc">&#39;7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="mf">0.888889</span><span class="p">,</span><span class="mf">0.11111111</span><span class="p">);</span>    
        
    <span class="k">for</span><span class="p">(</span><span class="n">string</span><span class="o">::</span><span class="n">size_type</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">original</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>    
    <span class="p">{</span>    
        <span class="kt">char</span> <span class="n">temp</span><span class="o">=</span><span class="n">original</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>    
        <span class="n">assert</span><span class="p">(</span><span class="n">char_freq</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">temp</span><span class="p">));</span>    
        
        <span class="kt">double</span> <span class="n">Range</span><span class="o">=</span><span class="n">High</span><span class="p">;</span>    
        <span class="n">High</span><span class="o">=</span><span class="n">High</span><span class="o">*</span><span class="n">char_freq</span><span class="p">[</span><span class="n">temp</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>    
        <span class="n">Low</span><span class="o">=</span><span class="n">Low</span><span class="o">+</span><span class="n">Range</span><span class="o">*</span><span class="n">char_freq</span><span class="p">[</span><span class="n">temp</span><span class="p">].</span><span class="n">first</span><span class="p">;</span>    
    <span class="p">}</span>    
    <span class="kt">double</span> <span class="n">result</span><span class="o">=</span><span class="n">Low</span><span class="p">;</span>    
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;Compression Result: &#34;</span><span class="o">&lt;&lt;</span><span class="n">result</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>    
    <span class="c1">//the core code to decompress    
</span><span class="c1"></span>    <span class="n">result</span> <span class="o">=</span> <span class="mf">0.1295556</span><span class="p">;</span>    
    <span class="kt">bool</span> <span class="n">goon</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>    
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;Original Text: &#34;</span><span class="p">;</span>    
    <span class="k">do</span><span class="p">{</span>    
        <span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">&gt;::</span><span class="n">const_iterator</span> <span class="n">itr</span><span class="o">=</span><span class="n">char_freq</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>    
        <span class="k">while</span><span class="p">(</span><span class="n">itr</span><span class="o">!=</span><span class="n">char_freq</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>    
        <span class="p">{</span>    
            <span class="k">if</span><span class="p">((</span><span class="n">result</span> <span class="o">-</span> <span class="n">itr</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="o">/</span> <span class="n">itr</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">second</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">result</span> <span class="o">-</span> <span class="n">itr</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="o">/</span> <span class="n">itr</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;=</span> <span class="mf">0.888889</span><span class="p">)</span>    
            <span class="p">{</span>    
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">itr</span><span class="o">-&gt;</span><span class="n">first</span><span class="p">;</span>    
                <span class="n">result</span><span class="o">=</span><span class="p">(</span><span class="n">result</span> <span class="o">-</span> <span class="n">itr</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="o">/</span> <span class="n">itr</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>    
                <span class="k">break</span><span class="p">;</span>    
            <span class="p">}</span>    
            <span class="o">++</span><span class="n">itr</span><span class="p">;</span>    
        <span class="p">}</span>    
        <span class="k">if</span><span class="p">(</span><span class="n">itr</span><span class="o">==</span><span class="n">char_freq</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>    
            <span class="n">goon</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>    
    <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="n">goon</span><span class="p">);</span>    
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>    
<span class="p">}</span>    
</code></pre></td></tr></table>
</div>
</div><p>因为给的浮点数是一个范围,所以还原出来的原始字符串并不完全正确,最后一位有一些区别,但是因为字符只能是给定的6个字符,所以还比较容易试出来结果。</p>
<h2 id="veryeasyre">Veryeasyre</h2>
<p>一共有两个验证,第一层验证是一个。(总字符串的长度是81,输入的字符串依次填补在总字符串中为0的地方,填补完以后9*9的数组中,每行每列每个3*3块都是数字1-9),原始字符串如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="mi">0</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">0</span> <span class="mi">9</span> <span class="mi">4</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>     
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">5</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">9</span>     
<span class="mi">0</span> <span class="mi">7</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>     
<span class="mi">0</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">6</span>     
<span class="mi">8</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">5</span>     
<span class="mi">5</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">8</span>     
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">7</span> <span class="mi">0</span>     
<span class="mi">7</span> <span class="mi">4</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">6</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>     
<span class="mi">3</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">0</span> <span class="mi">0</span>    
</code></pre></td></tr></table>
</div>
</div><p>输入的字符串依次填补在0处,找到了一个求的代码:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">re</span>    
<span class="kn">import</span> <span class="nn">copy</span>    
    
<span class="c1"># 默认模板--&gt;在这里写准备求的    </span>
<span class="n">sudoku_template1</span> <span class="o">=</span> <span class="p">[[</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">9</span> <span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">9</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">9</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">8</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">8</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">8</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">]]</span>    
    
    
<span class="c1"># 芬兰数学家英卡拉（Arto Inkala）设计的号称“最难” - 1000次平均耗时320ms/次    </span>
<span class="n">sudoku_template2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>    
    
<span class="k">def</span> <span class="nf">crack_it</span><span class="p">(</span><span class="n">sudoku</span><span class="o">=</span><span class="n">sudoku_template1</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;主函数,输入进行运算,如未输入则调用默认,格式为9x9的二维列表&#39;&#39;&#39;</span>    
    <span class="n">init_sudoku</span> <span class="o">=</span> <span class="n">str_to_num</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sudoku</span><span class="p">))</span>   <span class="c1"># Python的坑！列表或字典等对象作为函数参数时,函数可能修改其元素的指针,导致外部列表也会改变    </span>
    <span class="k">if</span> <span class="n">is_valid_sudoku</span><span class="p">(</span><span class="n">sudoku</span><span class="p">):</span>   <span class="c1"># 判断输入的Sudoku是否合理（是否冲突）    </span>
        <span class="n">candidate_list</span> <span class="o">=</span> <span class="n">filter_candidate_list</span><span class="p">(</span><span class="n">init_sudoku</span><span class="p">,</span> <span class="n">init_candidate_list</span><span class="p">(</span><span class="n">init_sudoku</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># 针对Sudoku中的每一个空格（空格都默认填入数字0）,都算出其可能的备选数,存入data_list中；每当空格被确认唯一值时,剩余data_list都需要再被刷新    </span>
        <span class="n">cracked_sudoku</span> <span class="o">=</span> <span class="n">fill_blank</span><span class="p">(</span><span class="n">init_sudoku</span><span class="p">,</span> <span class="n">candidate_list</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># 破解    </span>
        <span class="n">print_sudoku</span><span class="p">(</span><span class="n">cracked_sudoku</span><span class="p">)</span>   <span class="c1"># 在控制台显示已破解的,默认开启    </span>
        <span class="k">return</span> <span class="n">cracked_sudoku</span>    
    <span class="k">else</span><span class="p">:</span>    
        <span class="k">return</span> <span class="s1">&#39;请检查一下输入是否有误- -0&#39;</span>    
    
<span class="k">def</span> <span class="nf">str_to_num</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;初步校验+统一格式,空字符转0,无效字符转0&#39;&#39;&#39;</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;[1-9]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])):</span>   <span class="c1"># 1-9字符转int 1-9    </span>
                <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>    
            <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])):</span>   <span class="c1"># 空位转int 0    </span>
                <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    
            <span class="k">else</span><span class="p">:</span>   <span class="c1"># 无效字符转int 0,或者也可以return False,拒绝服务    </span>
                <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    
    <span class="k">return</span> <span class="n">data</span>    
                
    
<span class="k">def</span> <span class="nf">is_valid_sudoku</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;判断整个是否有效&#39;&#39;&#39;</span>    
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>    
                <span class="k">return</span> <span class="bp">False</span>    
        
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>    
                <span class="k">return</span> <span class="bp">False</span>    
        
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>    
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]:</span>    
                        <span class="k">return</span> <span class="bp">False</span>    
        
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>    
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>    
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">//</span><span class="mi">3</span><span class="p">))</span> <span class="o">!=</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>    
                        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">//</span><span class="mi">3</span><span class="p">)][</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">//</span><span class="mi">3</span><span class="p">)]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]:</span>    
                            <span class="k">return</span> <span class="bp">False</span>    
    <span class="k">return</span> <span class="bp">True</span>    
    
<span class="k">def</span> <span class="nf">init_candidate_list</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;初始化建立一个的备选数列表,一个空格就对应其坐标以及填上1~9的备选数字,格式为81x9的二维列表&#39;&#39;&#39;</span>    
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>    
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>    
                <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>    
    <span class="k">return</span> <span class="n">data_list</span>    
    
<span class="k">def</span> <span class="nf">filter_candidate_list</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;对的备选数表进行过滤,删除无效的备选数&#39;&#39;&#39;</span>    
    <span class="k">for</span> <span class="n">blank_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)):</span>    
        <span class="n">data_list</span><span class="p">[</span><span class="n">blank_index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>    
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>    
            <span class="k">if</span> <span class="n">is_valid_num</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="n">blank_index</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_list</span><span class="p">[</span><span class="n">blank_index</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="p">):</span>    
                <span class="n">data_list</span><span class="p">[</span><span class="n">blank_index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">data_list</span>    
    
<span class="k">def</span> <span class="nf">is_valid_num</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;输入、坐标、数字,判断该位置填入该数字是否合理&#39;&#39;&#39;</span>    
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>   <span class="c1"># 行判断    </span>
        <span class="k">return</span> <span class="bp">False</span>    
        
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>   <span class="c1"># 列判断    </span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>    
            <span class="k">return</span> <span class="bp">False</span>    
        
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>   <span class="c1"># 九宫格判断    </span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>    
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">//</span><span class="mi">3</span><span class="p">)][</span><span class="n">b</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">//</span><span class="mi">3</span><span class="p">)]</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>    
                <span class="k">return</span> <span class="bp">False</span>    
    <span class="k">return</span> <span class="bp">True</span>    
    
<span class="k">def</span> <span class="nf">fill_blank</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;    
</span><span class="s1">    核心函数,递归尝试代入备选数,类似深度优先遍历算法。    
</span><span class="s1">    一旦某位置填入为True（由is_valid_num函数判断）,则开始下一位置的填入；若某位置填入为False,则return回上一级。    
</span><span class="s1">    参数解释：    
</span><span class="s1">    data: 矩阵,二维列表    
</span><span class="s1">    data_list: 备选数表,二维列表    
</span><span class="s1">    start: 递归进行的位置,对应data_list的下标    
</span><span class="s1">    &#39;&#39;&#39;</span>    
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>    
    <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>    
        <span class="n">one</span> <span class="o">=</span> <span class="n">data_list</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>    
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">one</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>    
            <span class="k">if</span> <span class="n">is_valid_num</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">one</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">one</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="p">):</span>    
                <span class="n">data</span><span class="p">[</span><span class="n">one</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]][</span><span class="n">one</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">num</span>   <span class="c1"># 赋值,如果能给每一格成功赋值,则意味破解成功；如果出现失败,则需要将错误赋值清零    </span>
                <span class="c1"># data_list = filter_candidate_list(data, data_list, start)   # 每一步赋值都会改变备选数表,但刷新备选数表的操作非常耗时,若加上这句,速度会慢100倍    </span>
                <span class="n">tem_data</span> <span class="o">=</span> <span class="n">fill_blank</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># start+1,使递归进入下一格点    </span>
                <span class="k">if</span> <span class="n">tem_data</span><span class="p">:</span>   <span class="c1"># 注意！如果下一格点return,分两种情况：1.成功破解所有格点；2.发生错误,for loop结束也会return,此时返回值为None    </span>
                    <span class="k">return</span> <span class="n">tem_data</span>    
        <span class="n">data</span><span class="p">[</span><span class="n">one</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]][</span><span class="n">one</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># 注意！可能向下递归了若干格才发现前面是错误的（即for loop结束,return None）,此时需要将所有错误的赋值清零。    </span>
    <span class="k">else</span><span class="p">:</span>    
        <span class="k">return</span> <span class="n">data</span>    
    
<span class="k">def</span> <span class="nf">print_sudoku</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>    
    <span class="s1">&#39;&#39;&#39;打印到控制台&#39;&#39;&#39;</span>    
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt; 破解结果:&#39;</span><span class="p">)</span>    
    <span class="c1"># for i in range(9):    </span>
    <span class="c1">#     for j in range(9):    </span>
    <span class="c1">#         print(&#39;{:^3}&#39;.format(data[i][j]), end=&#39;&#39;)    </span>
    <span class="c1">#     print(&#39;&#39;)    </span>
    <span class="c1"># print(&#39;&#39;)    </span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>    
            <span class="k">if</span> <span class="n">sudoku_template1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>    
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>    
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1">#输出原始中是0的部分    </span>
    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>    
    <span class="n">crack_it</span><span class="p">()</span>    
</code></pre></td></tr></table>
</div>
</div><p>在验证通过后做了一个异或运算并且提示&quot;This is part of the key&quot;(ps:真的每一句提示都要仔细琢磨一下&hellip;),异或一下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">idc</span>    
<span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;28163746738936845178453226739434617961829429853594162&#34;</span>    
<span class="n">key</span> <span class="o">=</span> <span class="p">[]</span>    
<span class="n">ex</span> <span class="o">=</span> <span class="mh">0x277190</span>    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>    
    <span class="n">a</span> <span class="o">=</span> <span class="n">idc</span><span class="o">.</span><span class="n">Dword</span><span class="p">(</span><span class="n">ex</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>    
    <span class="n">key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]))</span>    
<span class="k">print</span> <span class="n">key</span>    
<span class="k">print</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">key</span><span class="p">)</span>    
<span class="c1">#fa{3cmtL!#U_vr03 &lt;--输出    </span>
</code></pre></td></tr></table>
</div>
</div><p>后面的代码要求输入长度为32的字符串,使用一个流密码算法加密,加密的密钥是输入字符串的奇数位组成的16位字符串,根据刚才part of the key的提示,以及输出字符串的内容可以联想到,<code>fa{3cmtL!#U_vr03</code>就是输入的奇数位字符串,任意补全偶数位,就可以得到经过变换后的key,将这些key与加密后的内容异或就可以得到flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xd4</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">]</span>  <span class="c1">#流密码中变换后的key    </span>
<span class="n">enc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">215</span><span class="p">]</span>    
<span class="k">print</span> <span class="n">enc</span>    
<span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>    
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[(</span><span class="n">i</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="p">])</span>    
<span class="k">print</span> <span class="n">s</span>    
<span class="c1"># flag{W3lcometoL0!_#ZUC_Ev3ry0n3}    </span>
</code></pre></td></tr></table>
</div>
</div><p>看到wp中提到,这个流密码是ZUC,给了一个ZUC的源码,学习一下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cm">/* ————————————W—————————- */</span>    
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">u8</span><span class="p">;</span>    
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">u32</span><span class="p">;</span>    
<span class="cm">/* —————————————t————————- */</span>    
<span class="cm">/* the state registers of LFSR 16 cells*/</span>    
<span class="n">u32</span> <span class="n">LFSR_S0</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S1</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S2</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S3</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S4</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S5</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S6</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S7</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S8</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S9</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S10</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S11</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S12</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S13</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S14</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">LFSR_S15</span><span class="p">;</span>    
<span class="cm">/* the registers of f算法中的R1,R2 */</span>    
<span class="n">u32</span> <span class="n">F_R1</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">F_R2</span><span class="p">;</span>    
<span class="cm">/* the outputs of BitReorganization BR中的X0,X1,X2,X3*/</span>    
<span class="n">u32</span> <span class="n">BRC_X0</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">BRC_X1</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">BRC_X2</span><span class="p">;</span>    
<span class="n">u32</span> <span class="n">BRC_X3</span><span class="p">;</span>    
<span class="cm">/* the s-boxes 两个S盒*/</span>    
<span class="n">u8</span> <span class="n">S0</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>    
<span class="mh">0x3e</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0xb9</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span>    
<span class="mh">0x7b</span><span class="p">,</span><span class="mh">0x1b</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0xaf</span><span class="p">,</span><span class="mh">0x9d</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0xfc</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span>    
<span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0xce</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0xdd</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span>    
<span class="mh">0xcd</span><span class="p">,</span><span class="mh">0xc1</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0xfd</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0xd4</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span>    
<span class="mh">0x76</span><span class="p">,</span><span class="mh">0x7d</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0xa7</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0xed</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0xf3</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x9b</span><span class="p">,</span>    
<span class="mh">0xe3</span><span class="p">,</span><span class="mh">0xef</span><span class="p">,</span><span class="mh">0x5e</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x5f</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span>    
<span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0xd5</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0xa8</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xd8</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0xad</span><span class="p">,</span>    
<span class="mh">0x3b</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0xde</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x2f</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span>    
<span class="mh">0xb1</span><span class="p">,</span><span class="mh">0xb4</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0xf7</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x7c</span><span class="p">,</span><span class="mh">0xcc</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0xc3</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span>    
<span class="mh">0x07</span><span class="p">,</span><span class="mh">0xbf</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span>    
<span class="mh">0xbc</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0xa3</span><span class="p">,</span><span class="mh">0xfb</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0xf2</span><span class="p">,</span><span class="mh">0xe1</span><span class="p">,</span><span class="mh">0xe5</span><span class="p">,</span><span class="mh">0xe9</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span>    
<span class="mh">0xd0</span><span class="p">,</span><span class="mh">0xdc</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x5c</span><span class="p">,</span><span class="mh">0xec</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0xf5</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x9c</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span>    
<span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0xe6</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x9f</span><span class="p">,</span><span class="mh">0xf1</span><span class="p">,</span>    
<span class="mh">0xf6</span><span class="p">,</span><span class="mh">0xfa</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0xd2</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0xd6</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0xc4</span><span class="p">,</span><span class="mh">0xe2</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span>    
<span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x6b</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0xa1</span><span class="p">,</span><span class="mh">0xe8</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span>    
<span class="mh">0x8d</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xb3</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0xf4</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0xee</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x60</span>    
<span class="p">};</span>    
<span class="c1">//s0盒    
</span><span class="c1"></span><span class="n">u8</span> <span class="n">S1</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>    
<span class="mh">0x55</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x3b</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0x9f</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xfd</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span>    
<span class="mh">0x8c</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0xa8</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span>    
<span class="mh">0x44</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x3e</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0xa7</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0xe1</span><span class="p">,</span>    
<span class="mh">0x3a</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xb3</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0xbf</span><span class="p">,</span><span class="mh">0xdc</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0xfa</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span>    
<span class="mh">0xdd</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0xc1</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0xf6</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0xf5</span><span class="p">,</span><span class="mh">0xd4</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span>    
<span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0xd2</span><span class="p">,</span><span class="mh">0x9c</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0xbc</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0xd6</span><span class="p">,</span><span class="mh">0x8d</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span>    
<span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0xd8</span><span class="p">,</span><span class="mh">0x5c</span><span class="p">,</span><span class="mh">0xa1</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0xfb</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0xd5</span><span class="p">,</span><span class="mh">0x7d</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span>    
<span class="mh">0xee</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="mh">0xe5</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span>    
<span class="mh">0xad</span><span class="p">,</span><span class="mh">0xf1</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0xfc</span><span class="p">,</span><span class="mh">0xf4</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0xe8</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0xe9</span><span class="p">,</span>    
<span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x5e</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x9d</span><span class="p">,</span><span class="mh">0xb9</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0xcd</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span>    
<span class="mh">0x01</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x5f</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span>    
<span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0xce</span><span class="p">,</span><span class="mh">0xed</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0xb4</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0xcc</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0xc3</span><span class="p">,</span><span class="mh">0xde</span><span class="p">,</span>    
<span class="mh">0xa3</span><span class="p">,</span><span class="mh">0xef</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0xe6</span><span class="p">,</span><span class="mh">0x6b</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0xec</span><span class="p">,</span><span class="mh">0x1b</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xf7</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span>    
<span class="mh">0x5a</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0xc4</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span>    
<span class="mh">0x88</span><span class="p">,</span><span class="mh">0xb1</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x7c</span><span class="p">,</span><span class="mh">0xf3</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x7b</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span>    
<span class="mh">0x64</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x9b</span><span class="p">,</span><span class="mh">0x2f</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0xaf</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0xe2</span><span class="p">,</span><span class="mh">0xf2</span>    
<span class="p">};</span>    
<span class="c1">//s1盒    
</span><span class="c1"></span><span class="cm">/* the constants D */</span>    
<span class="n">u32</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>    
<span class="mh">0x44D7</span><span class="p">,</span> <span class="mh">0x26BC</span><span class="p">,</span> <span class="mh">0x626B</span><span class="p">,</span> <span class="mh">0x135E</span><span class="p">,</span> <span class="mh">0x5789</span><span class="p">,</span> <span class="mh">0x35E2</span><span class="p">,</span> <span class="mh">0x7135</span><span class="p">,</span> <span class="mh">0x09AF</span><span class="p">,</span>    
<span class="mh">0x4D78</span><span class="p">,</span> <span class="mh">0x2F13</span><span class="p">,</span> <span class="mh">0x6BC4</span><span class="p">,</span> <span class="mh">0x1AF1</span><span class="p">,</span> <span class="mh">0x5E26</span><span class="p">,</span> <span class="mh">0x3C4D</span><span class="p">,</span> <span class="mh">0x789A</span><span class="p">,</span> <span class="mh">0x47AC</span>    
<span class="p">};</span>    
<span class="cm">/* ——————————————————————- */</span>    
<span class="cm">/* c = a + b mod (2^31 – 1)  那个附录里复杂的计算*/</span>    
<span class="n">u32</span> <span class="nf">AddM</span><span class="p">(</span><span class="n">u32</span> <span class="n">a</span><span class="p">,</span> <span class="n">u32</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>    
	<span class="n">u32</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>    
	<span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&amp;</span> <span class="mh">0x7FFFFFFF</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span><span class="p">);</span>    
<span class="p">}</span>    
<span class="cm">/* LFSR with initialization mode */</span>    
<span class="cp">#define MulByPow2(x, k) ((((x) &lt;&lt; k) | ((x) &gt;&gt; (31 - k))) &amp; 0x7FFFFFFF)     
</span><span class="cp"></span><span class="kt">void</span> <span class="nf">LFSRWithInitialisationMode</span><span class="p">(</span><span class="n">u32</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>    
	<span class="n">u32</span> <span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">LFSR_S0</span><span class="p">;</span>    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S0</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S4</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S10</span><span class="p">,</span> <span class="mi">21</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S13</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S15</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>    
	<span class="cm">/* update the state */</span>    
	<span class="n">LFSR_S0</span> <span class="o">=</span> <span class="n">LFSR_S1</span><span class="p">;</span>    
	<span class="n">LFSR_S1</span> <span class="o">=</span> <span class="n">LFSR_S2</span><span class="p">;</span>    
	<span class="n">LFSR_S2</span> <span class="o">=</span> <span class="n">LFSR_S3</span><span class="p">;</span>    
	<span class="n">LFSR_S3</span> <span class="o">=</span> <span class="n">LFSR_S4</span><span class="p">;</span>    
	<span class="n">LFSR_S4</span> <span class="o">=</span> <span class="n">LFSR_S5</span><span class="p">;</span>    
	<span class="n">LFSR_S5</span> <span class="o">=</span> <span class="n">LFSR_S6</span><span class="p">;</span>    
	<span class="n">LFSR_S6</span> <span class="o">=</span> <span class="n">LFSR_S7</span><span class="p">;</span>    
	<span class="n">LFSR_S7</span> <span class="o">=</span> <span class="n">LFSR_S8</span><span class="p">;</span>    
	<span class="n">LFSR_S8</span> <span class="o">=</span> <span class="n">LFSR_S9</span><span class="p">;</span>    
	<span class="n">LFSR_S9</span> <span class="o">=</span> <span class="n">LFSR_S10</span><span class="p">;</span>    
	<span class="n">LFSR_S10</span> <span class="o">=</span> <span class="n">LFSR_S11</span><span class="p">;</span>    
	<span class="n">LFSR_S11</span> <span class="o">=</span> <span class="n">LFSR_S12</span><span class="p">;</span>    
	<span class="n">LFSR_S12</span> <span class="o">=</span> <span class="n">LFSR_S13</span><span class="p">;</span>    
	<span class="n">LFSR_S13</span> <span class="o">=</span> <span class="n">LFSR_S14</span><span class="p">;</span>    
	<span class="n">LFSR_S14</span> <span class="o">=</span> <span class="n">LFSR_S15</span><span class="p">;</span>    
	<span class="n">LFSR_S15</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>    
<span class="p">}</span>    
<span class="cm">/* LFSR with work mode 工作模式*/</span>    
<span class="kt">void</span> <span class="nf">LFSRWithWorkMode</span><span class="p">()</span> <span class="p">{</span>    
	<span class="n">u32</span> <span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">LFSR_S0</span><span class="p">;</span>    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S0</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S4</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S10</span><span class="p">,</span> <span class="mi">21</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S13</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="n">v</span> <span class="o">=</span> <span class="n">MulByPow2</span><span class="p">(</span><span class="n">LFSR_S15</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>    
	<span class="n">f</span> <span class="o">=</span> <span class="n">AddM</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    
    
	<span class="cm">/* update the state */</span>    
	<span class="n">LFSR_S0</span> <span class="o">=</span> <span class="n">LFSR_S1</span><span class="p">;</span>    
	<span class="n">LFSR_S1</span> <span class="o">=</span> <span class="n">LFSR_S2</span><span class="p">;</span>    
	<span class="n">LFSR_S2</span> <span class="o">=</span> <span class="n">LFSR_S3</span><span class="p">;</span>    
	<span class="n">LFSR_S3</span> <span class="o">=</span> <span class="n">LFSR_S4</span><span class="p">;</span>    
	<span class="n">LFSR_S4</span> <span class="o">=</span> <span class="n">LFSR_S5</span><span class="p">;</span>    
	<span class="n">LFSR_S5</span> <span class="o">=</span> <span class="n">LFSR_S6</span><span class="p">;</span>    
	<span class="n">LFSR_S6</span> <span class="o">=</span> <span class="n">LFSR_S7</span><span class="p">;</span>    
	<span class="n">LFSR_S7</span> <span class="o">=</span> <span class="n">LFSR_S8</span><span class="p">;</span>    
	<span class="n">LFSR_S8</span> <span class="o">=</span> <span class="n">LFSR_S9</span><span class="p">;</span>    
	<span class="n">LFSR_S9</span> <span class="o">=</span> <span class="n">LFSR_S10</span><span class="p">;</span>    
	<span class="n">LFSR_S10</span> <span class="o">=</span> <span class="n">LFSR_S11</span><span class="p">;</span>    
	<span class="n">LFSR_S11</span> <span class="o">=</span> <span class="n">LFSR_S12</span><span class="p">;</span>    
	<span class="n">LFSR_S12</span> <span class="o">=</span> <span class="n">LFSR_S13</span><span class="p">;</span>    
	<span class="n">LFSR_S13</span> <span class="o">=</span> <span class="n">LFSR_S14</span><span class="p">;</span>    
	<span class="n">LFSR_S14</span> <span class="o">=</span> <span class="n">LFSR_S15</span><span class="p">;</span>    
	<span class="n">LFSR_S15</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>    
<span class="p">}</span>    
    
<span class="cm">/* BitReorganization */</span>    
<span class="kt">void</span> <span class="nf">BitReorganization</span><span class="p">()</span> <span class="p">{</span>    
	<span class="n">BRC_X0</span> <span class="o">=</span> <span class="p">((</span><span class="n">LFSR_S15</span> <span class="o">&amp;</span> <span class="mh">0x7FFF8000</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">LFSR_S14</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">);</span>    
	<span class="n">BRC_X1</span> <span class="o">=</span> <span class="p">((</span><span class="n">LFSR_S11</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">LFSR_S9</span> <span class="o">&gt;&gt;</span> <span class="mi">15</span><span class="p">);</span>    
	<span class="n">BRC_X2</span> <span class="o">=</span> <span class="p">((</span><span class="n">LFSR_S7</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">LFSR_S5</span> <span class="o">&gt;&gt;</span> <span class="mi">15</span><span class="p">);</span>    
	<span class="n">BRC_X3</span> <span class="o">=</span> <span class="p">((</span><span class="n">LFSR_S2</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">LFSR_S0</span> <span class="o">&gt;&gt;</span> <span class="mi">15</span><span class="p">);</span>    
<span class="p">}</span>    
<span class="cp">#define ROT(a, k) (((a) &lt;&lt; k) | ((a) &gt;&gt; (32 - k)))    
</span><span class="cp"></span><span class="cm">/* L1 */</span>    
<span class="n">u32</span> <span class="nf">L1</span><span class="p">(</span><span class="n">u32</span> <span class="n">X</span><span class="p">)</span> <span class="p">{</span>    
	<span class="k">return</span> <span class="p">(</span><span class="n">X</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">24</span><span class="p">));</span>    
<span class="p">}</span>    
<span class="cm">/* L2 */</span>    
<span class="n">u32</span> <span class="nf">L2</span><span class="p">(</span><span class="n">u32</span> <span class="n">X</span><span class="p">)</span> <span class="p">{</span>    
	<span class="k">return</span> <span class="p">(</span><span class="n">X</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span> <span class="o">^</span> <span class="n">ROT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">30</span><span class="p">));</span>    
<span class="p">}</span>    
<span class="cp">#define MAKEU32(a, b, c, d) (((u32)(a) &lt;&lt; 24) | ((u32)(b) &lt;&lt; 16) | ((u32)(c) &lt;&lt; 8) | ((u32)(d)))    
</span><span class="cp"></span><span class="cm">/* F */</span>    
<span class="n">u32</span> <span class="nf">F</span><span class="p">()</span> <span class="p">{</span>    
	<span class="n">u32</span> <span class="n">W</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>    
	<span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="n">BRC_X0</span> <span class="o">^</span> <span class="n">F_R1</span><span class="p">)</span> <span class="o">+</span> <span class="n">F_R2</span><span class="p">;</span>    
	<span class="n">W1</span> <span class="o">=</span> <span class="n">F_R1</span> <span class="o">+</span> <span class="n">BRC_X1</span><span class="p">;</span>    
	<span class="n">W2</span> <span class="o">=</span> <span class="n">F_R2</span> <span class="o">^</span> <span class="n">BRC_X2</span><span class="p">;</span>    
	<span class="n">u</span> <span class="o">=</span> <span class="n">L1</span><span class="p">((</span><span class="n">W1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">W2</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">));</span>    
	<span class="n">v</span> <span class="o">=</span> <span class="n">L2</span><span class="p">((</span><span class="n">W2</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">W1</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">));</span>    
	<span class="n">F_R1</span> <span class="o">=</span> <span class="n">MAKEU32</span><span class="p">(</span><span class="n">S0</span><span class="p">[</span><span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">],</span> <span class="n">S1</span><span class="p">[(</span><span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">],</span>    
		<span class="n">S0</span><span class="p">[(</span><span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">],</span> <span class="n">S1</span><span class="p">[</span><span class="n">u</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]);</span>    
	<span class="n">F_R2</span> <span class="o">=</span> <span class="n">MAKEU32</span><span class="p">(</span><span class="n">S0</span><span class="p">[</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">],</span> <span class="n">S1</span><span class="p">[(</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">],</span>    
		<span class="n">S0</span><span class="p">[(</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">],</span> <span class="n">S1</span><span class="p">[</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]);</span>    
	<span class="k">return</span> <span class="n">W</span><span class="p">;</span>    
<span class="p">}</span>    
<span class="cp">#define MAKEU31(a, b, c)(((u32)(a) &lt;&lt; 23)|((u32)(b) &lt;&lt; 8)|(u32)(c))    
</span><span class="cp"></span><span class="cm">/* initialize */</span>    
<span class="c1">//初始化    
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">Initialization</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">iv</span><span class="p">)</span> <span class="p">{</span>    
	<span class="n">u32</span> <span class="n">w</span><span class="p">,</span> <span class="n">nCount</span><span class="p">;</span>    
    
	<span class="cm">/* expand key */</span>    
	<span class="n">LFSR_S0</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>    
	<span class="n">LFSR_S1</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>    
	<span class="n">LFSR_S2</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>    
	<span class="n">LFSR_S3</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>    
	<span class="n">LFSR_S4</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>    
	<span class="n">LFSR_S5</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>    
	<span class="n">LFSR_S6</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>    
	<span class="n">LFSR_S7</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">7</span><span class="p">]);</span>    
	<span class="n">LFSR_S8</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span>    
	<span class="n">LFSR_S9</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>    
	<span class="n">LFSR_S10</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">10</span><span class="p">]);</span>    
	<span class="n">LFSR_S11</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">11</span><span class="p">]);</span>    
	<span class="n">LFSR_S12</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">12</span><span class="p">]);</span>    
	<span class="n">LFSR_S13</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">13</span><span class="p">]);</span>    
	<span class="n">LFSR_S14</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">14</span><span class="p">]);</span>    
	<span class="n">LFSR_S15</span> <span class="o">=</span> <span class="n">MAKEU31</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">EK_d</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">iv</span><span class="p">[</span><span class="mi">15</span><span class="p">]);</span>    
	<span class="cm">/* set F_R1 and F_R2 to zero */</span>    
	<span class="n">F_R1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
	<span class="n">F_R2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
	<span class="n">nCount</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>    
	<span class="k">while</span> <span class="p">(</span><span class="n">nCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>    
	<span class="p">{</span>    
		<span class="n">BitReorganization</span><span class="p">();</span>    
		<span class="n">w</span> <span class="o">=</span> <span class="n">F</span><span class="p">();</span>    
		<span class="n">LFSRWithInitialisationMode</span><span class="p">(</span><span class="n">w</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">);</span>    
		<span class="n">nCount</span><span class="o">--</span><span class="p">;</span>    
	<span class="p">}</span>    
<span class="p">}</span>    
<span class="c1">//生成密钥流    
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">GenerateKeystream</span><span class="p">(</span><span class="n">u32</span><span class="o">*</span> <span class="n">pKeystream</span><span class="p">,</span> <span class="kt">int</span> <span class="n">KeystreamLen</span><span class="p">)</span> <span class="p">{</span>    
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>    
	<span class="p">{</span>    
		<span class="n">BitReorganization</span><span class="p">();</span>    
		<span class="n">F</span><span class="p">();</span>		<span class="cm">/* discard the output of F */</span>    
		<span class="n">LFSRWithWorkMode</span><span class="p">();</span>    
	<span class="p">}</span>    
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">KeystreamLen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    
		<span class="n">BitReorganization</span><span class="p">();</span>    
		<span class="n">pKeystream</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">()</span> <span class="o">^</span> <span class="n">BRC_X3</span><span class="p">;</span>    
		<span class="n">LFSRWithWorkMode</span><span class="p">();</span>    
	<span class="p">}</span>    
<span class="p">}</span>    
<span class="kt">void</span> <span class="nf">ZUC</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">iv</span><span class="p">,</span> <span class="n">u32</span><span class="o">*</span> <span class="n">ks</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>    
<span class="p">{</span>      
	<span class="cm">/* The initialization of ZUC, see page 17 of ref. [3]*/</span>    
	<span class="n">Initialization</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">iv</span><span class="p">);</span>    
	<span class="cm">/*  The procedure of generating keystream of ZUC, see page 18 of ref. [3]*/</span>    
	<span class="n">GenerateKeystream</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>    
<span class="p">}</span>    
<span class="c1">// 在这里加密    
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">EEA3</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span> <span class="n">CK</span><span class="p">,</span> <span class="n">u32</span> <span class="n">COUNT</span><span class="p">,</span> <span class="n">u32</span> <span class="n">BEARER</span><span class="p">,</span> <span class="n">u32</span> <span class="n">DIRECTION</span><span class="p">,</span> <span class="n">u32</span> <span class="n">LENGTH</span><span class="p">,</span> <span class="n">u32</span><span class="o">*</span> <span class="n">M</span><span class="p">,</span> <span class="n">u32</span><span class="o">*</span> <span class="n">C</span><span class="p">)</span>    
<span class="p">{</span>    
	<span class="n">u32</span><span class="o">*</span> <span class="n">z</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">i</span><span class="p">;</span>    
	<span class="n">u8</span> <span class="n">IV</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>    
	<span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">LENGTH</span> <span class="o">+</span> <span class="mi">31</span><span class="p">)</span> <span class="o">/</span> <span class="mi">32</span><span class="p">;</span>    
	<span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">u32</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">L</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">));</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">COUNT</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">COUNT</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">COUNT</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">COUNT</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">BEARER</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">DIRECTION</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFC</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>    
	<span class="n">IV</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">IV</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>    
	<span class="n">ZUC</span><span class="p">(</span><span class="n">CK</span><span class="p">,</span> <span class="n">IV</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">L</span><span class="p">);</span>    
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>    
	<span class="p">{</span>    
		<span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>    
	<span class="p">}</span>    
	<span class="n">free</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>    
<span class="p">}</span>    
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2020-04-05</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/" data-title="i春秋公益赛_部分re题目"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/" data-title="i春秋公益赛_部分re题目"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/" data-title="i春秋公益赛_部分re题目"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://linkleyping.top/2020i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B/" data-title="i春秋公益赛_部分re题目"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/nu1l%E7%AC%AC%E4%B8%80%E6%AC%A1re%E5%85%AC%E5%BC%80%E8%B5%9B/" class="prev" rel="prev" title="Nu1L第一次RE公开赛WP"><i class="fas fa-angle-left fa-fw"></i>Nu1L第一次RE公开赛WP</a>
            <a href="/%E6%AF%8F%E6%97%A5%E6%80%BB%E7%BB%93-%E7%AC%AC%E5%8D%81%E5%A4%A9%E6%B1%87%E7%BC%96%E8%80%83%E8%AF%95%E5%87%86%E5%A4%87/" class="next" rel="next" title="汇编基础">汇编基础<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.80.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div>
                <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
                <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
            

            <div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2022</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":100},"comment":{},"search":{"algoliaAppID":"RFO4PNFHT1","algoliaIndex":"blog","algoliaSearchKey":"d13f32411166c6212551ffa815910ba5","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
